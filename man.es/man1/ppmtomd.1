PPMTOMD(1)                                             PPMTOMD(1)



NAME
       ppmtomd  -  convert PPM files to the Alps MicroDry printer
       format

SYNOPSIS
       ppmtomd [ options ] [ PPM-file ]


DESCRIPTION
       A program to convert images from PPM format into the  con­
       trol  language for the Alps Micro-Dry printers, at various
       times sold by Citizen, Alps and Okidata.

       The input image is printed as one page.  However,  ppmtomd
       will  correctly  handle concatenated PPM files by printing
       each file on a separate page, allowing it to be used as  a
       filter for GhostScript with PPM output.

       If  no  input  file  is given, ppmtomd reads from standard
       input.  It does not spool its input to disk;  however,  it
       does  store  several intermediate files, and for a typical
       A4 photo image printed in standard  mode,  at  least  20MB
       should  be  available in the temporary directory (/tmp, or
       the environment variable TMPDIR), or 80MB in the (not  yet
       implemented) dye-sub and vphoto modes.

       The  formatted  output is sent to standard output. ppmtomd
       does not at present try to read any information  from  the
       printer,  so  the  output can be sent to a spooler or any­
       where else as desired.


OPTIONS
       For both option names and values  that  are  options,  any
       unambiguous  (case-insensitive)  prefix  may  be used. For
       example, the -datamode option  takes  arguments  including
       Black, Colour, Cassette, but it is enough to give b,co,ca.


   -autoshift
       This option shifts the image appropriately to take account
       of  the  unprintable areas on the paper, assuming that the
       input image occupies the full area of the paper. Thus if a
       PPM image is generated by giving the -sPAPERSIZE=a4 option
       to  GhostScript,  ppmtomd  should  be  given  the  options
       -papersize A4 -autoshift.


   -black
       This  option sets black monochrome printing. It is equiva­
       lent to -monochrome -datamode Black.


   -colourcorrection mode
       This option specifies what  colour  correction  is  to  be
       applied. The possible values are:

       None   No  colour  correction  at  all  is done; in colour
              printing modes, the RGB input  data  will  be  con­
              verted to CMY with no black.

       Plain  The  RGB  input will be converted to CMYK with full
              black generation and undercolour removal.  This  is
              the default when no dithering is done.

       Photo  In  this  mode,  monochrome data will be subject to
              gamma correction (see -gamma), and colour data will
              be  subject to a complex home-brewed colour correc­
              tion  procedure,  which  can  be  affected  by  the
              -gamma,  -satgamma and -keepblack options.  This is
              the default when dithering is specified.


   -colours colour-spec
       This option specifies which components of  the  image  are
       printed,  and  what  colours  are  used to print them.  In
       monochrome modes, there is only one component,  called  K,
       and  in  colour  modes  there are four, called K, C, M, Y,
       corresponding to the black, cyan, magenta and yellow  com­
       ponents  of the output images. These components are gener­
       ated according to the colour mode  and  colour  correction
       options;  however,  they  need  not  all  be  printed. The
       colour-spec is a comma-separated list of components to  be
       printed.  For  example,  -colours  c,y will print only the
       cyan and yellow planes of the image.  These components are
       always printed in the order C,M,Y,K.
       If  no  CMYK  colours are to be printed, give - or none as
       the colour-spec.

       NOTE: the following functionality  is  available  but  not
       recommended: use the -spotcolours option for printing spot
       colours.  Each component may  be  optionally  followed  by
       =colour,  where  colour  is  a  cassette  supported by the
       printer. This causes the given colour to  be  printed  for
       the   component.   For  example,  -colours  c=MetallicSil­
       ver,y=MetallicGold will print an image in silver and gold,
       the  silver  parts being represented by cyan in the input,
       and the gold parts by yellow. Colours may  be  given  with
       full  names or with abbreviations. The currently supported
       list of colours is given under  the  -spotcolours  option;
       however,  note  that the foil colours require special pro­
       cessing that will not happen if they are used here.


   -datamode mode
       This option specifies how the different colours  are  sent
       to  the  printer. Generally this option need not be given,
       as the driver will choose appropriate modes  depending  on
       other  options; indeed, it should not be given by the user
       unless they have a full understanding of the internals  of
       both the printer and the driver. For a full description of
       modes, see the note (***) in the technical section of this
       man page. The possible values are:

       Colour The  default  mode,  in  which the four colours are
              sent a page at a time, in the order cyan,  magenta,
              yellow, black.

       Black  The  mode  for  monochrome  data, printing in black
              only.

       EconoBlack
              Like Black, but uses the  re-usable  economy  black
              ribbon.  Available  only  with  the  5000 and later
              printers.

       Cassette
              This mode is like Colour, but  the  colours  black,
              cyan,  magenta,  yellow  are  instead  printed with
              whatever cassettes  are  in  holders  1,  2,  3,  4
              respectively.  In  this mode, the printing order is
              1, 2, 3, 4. *** Available only on the pre-5000 mod­
              els. See the technical section for caveats. (***)

       RasterColour
              In this mode, each line of the image is sent in all
              four colours, then the next line, and  so  on.  The
              printer  prints  one band in the four colours, then
              the next band, and so on. This mode is required for
              the  multi-colour  YMC  ribbon  available  for  the
              pre-5000 models; its use in any other case  is  not
              advised  (see  technical section ***). Available on
              the pre-5000 models only.

       RasterCassette
              This is the Cassette analogue of  the  RasterColour
              mode: data is transmitted a line at a time, and the
              colours black, cyan,  magenta,  yellow  are  inter­
              preted  as the cassettes in holders 1, 2, 3, 4. Use
              of this mode is not advised in any case.  Available
              on pre-5000 models only.

       MultiColour
              This  mode  is an extension of Colour mode allowing
              more than four components. Available  on  the  5000
              models  only. (My terminology is perhaps confusing:
              this is nothing to do with the multi-colour ribbon,
              which is not available on the 5000 series.)


   -dither dithering-mode
       This  option specifies what dithering should be applied to
       the input.  The possible modes are:

       None   The default: no dithering is done, and  the  output
              pixels  are  calculated in CMYK and then rounded to
              on or off. Use this mode if the dithering is to  be
              done by another program such as ghostscript.

       FloydSteinberg
              (also fs for short) uses a standard Floyd-Steinberg
              error diffusion algorithm. In  principle,  this  is
              not  a  good  technique  for  the MicroDry printing
              technology; however, it can give  good  results  in
              some circumstances.

       Halftone
              (also  ht  for  short) uses a clustered dot ordered
              dither with customized halftone screen angles. This
              is the dithering recommended for general use.

       Square This  is  a somewhat experimental technique that is
              only suitable for  use  in  the  RasterColour  data
              mode.  Not  recommended;  see the technical section
              for further information.


   -draft
       This option sets printing with  the  re-usable  EconoBlack
       ribbon  (MD-5000  and later models only). It is equivalent
       to -monochrome -datamode EconoBlack.


   -econoblack
       A synonym for -draft.


   -firstpass
       This is a specialist option. It tells the driver  that  it
       is  only handling the first of several passes, and that on
       exit the printer should be left in data transfer mode  and
       the paper backfed to top of form.


   -forcecurlcorrection
       This  option  forces  a paper curl correction pass even in
       overlay mode.


   -glossy
       This option tells the printer to  put  the  glossy  finish
       overcoat  on  the  image. This uses the printer's built-in
       facility for this: the glossy finish will  be  applied  to
       the  smallest  rectangle  bounding the printed area. Finer
       control can be achieved by using Finish as a spot  colour.


   -halftone
       This  is  a  compatibility  option,  equivalent to -dither
       Halftone.


   -informat input_type
       This option specifies how to treat the input. The possible
       values are

       Colour The  default  mode:  the input is a standard colour
              image, and  (unless  prevented  by  other  options)
              undergoes  colour correction and possibly dithering
              to generate four colour output.

       Monochrome
              The input is converted to a grey file,  gamma  cor­
              rection is applied and possibly dithering, and then
              all selected output  colours  are  printed  at  the
              resulting level. Note that this mode should usually
              only be used if just one  output  colour  is  being
              printed:  if  you  use  this option on its own, the
              result will be an image printed four times over, in
              each  colour!  This  mode  is  automatically set by
              appropriate user-level options such as -black.

       Diag   The input is in a special diagnostic  format  which
              codes  the value of a four colour pixel into an RGB
              pixel. This format is described  in  the  technical
              section (***).


   -gamma g
       This  option  sets  the  initial  gamma correction that is
       applied to input data. At  present,  in  monochrome  modes
       this  is  applied directly to the darkness k as k -> k**g;
       in colour modes, it is applied to the intensity v (in  HSV
       space) by (1-v) -> (1-v)**g.


   -inresolution res
       This  integer  valued  option  sets  the resolution of the
       input file if it is different from  the  printing  resolu­
       tion.  Currently  this is only supported for 600 dpi input
       and 1200 dpi output.


   -keepblack
       If this option is given, pure black in the input  will  be
       printed as pure black in the output, overriding the normal
       colour corrected value. This  option  is  appropriate  for
       mixes  of black text and images. However, for images with­
       out text, it is probably better not to give  this  option;
       without  it,  the  solid blacks will blend better with the
       surrounding colours.


   -lastpass
       This is a specialist option. It is like  -midpass,  except
       that  no  further  pass  follows,  so that curl correction
       should be performed, the paper ejected,  and  the  printer
       reset as normal.


   -lfadjust adjustment
       This  option  specifies the line feed adjustment, changing
       the amount by which the printhead advances between passes.
       If  thin  white  stripes  appear between bands, a negative
       lfadj can be used to remove them. May be useful with  very
       heavy paper or very light paper; the neutral setting seems
       correct for normal paper on my printer, but reports  vary.
       adjustment  is  in units of 1/9th of a (600dpi) pixel, and
       has possible values from -128 to +127.


   -midpass
       This is a specialist option. It tells the driver that  the
       printer  has  already been set up with appropriate values,
       and left in data transfer mode, so the driver should  sim­
       ply  print the specified components.  Unless the -lastpass
       option is also given, the printer will  be  left  in  data
       transfer mode.


   -model modelname
       This  option tells the driver which model of printer it is
       driving.  Possible values are:  Printiva-600 (the  Citizen
       Printiva  600C), Printiva-600U (the same, upgraded to rec­
       ognize  metallic  silver),   Printiva-700,   Printiva-1700
       (later   Citizen   models),   MD-2000,  MD-2010,  MD-4000,
       MD-2300,  MD-1000,  MD-1300,  MD-1500,  MD-5000,   MD-5500
       (Alps  models),  DP-5000  (Oki  models).   The  default is
       DP-5000 (can be changed at compile time) for  ppmtomd,  or
       Printiva-600U  if called as ppmtocpva (for compatibility).
       The main difference is between models before the  MD-5000,
       and  the 5000 onwards models; however, the driver tries to
       ensure that unsupported commands are  not  issued  to  the
       printer.


   -monochrome
       This  is  a  compatability  option,  and  is equivalent to
       -informat Monochrome.


   -nocurlcorrection
       This  option  suppresses  the  curl  correction  that  the
       printer  normally  performs  on  the last print pass. Note
       that the printer only performs curl  correction  on  paper
       media,  and that curl correction is automatically disabled
       in overlay mode.


   -nopack
       This is a debugging option only; it disables  the  use  of
       compression in the output.


   -noreset
       This  is  a  specialist  option. Normally, the driver will
       issue a printer reset  at  the  end  of  processing;  this
       option prevents it.


   -outformat output_format
       This option specifies what form of output the program gen­
       erates.  The values are:

       RGL    The default: output for driving the printer.

       PPM    The output is a PPM  file  with  each  pixel  being
              cyan,  magenta,  yellow, black or white as it would
              appear on the printer.

       Diag   The output is a PPM file  in  a  diagnostic  format
              which codes a CMYK pixel into an RGB pixel.

       ColourDiag
              The  output is the PPM file resulting from applying
              the colour correction routines to  the  input,  but
              without any other processing.


   -overlay
       If  this option is given, at the end of printing the paper
       will be returned to top of form so that further  data  can
       be  overlaid  on  the  same  page.   (Technical  note: the
       printer will be left in the idle mode.)


   -pageC -pageM -pageY -pageK
       These options are deprecated compatibility  options.  They
       specify  which  components  should  be  printed;  use  the
       -colours option instead.


   -pagelength length
       This option sets the length of the page, from top printing
       position  to bottom printing position. length may be given
       in the usual units of measurement; if no unit is given,  a
       unit  of  1/600 inch is assumed (regardless of the resolu­
       tion setting). This option is  usually  set  automatically
       from the paper size.


   -pagewidth width
       This option sets the printing width of the page. width may
       be given in the usual units of measurement; if no unit  is
       given,  a unit of 1/600 inch is assumed (regardless of the
       resolution setting). This option is usually set  automati­
       cally from the paper size.


   -papersize size
       This  option sets the size of the paper being used. Possi­
       ble values are Custom (the  length  and  width  should  be
       given by options), Executive, Letter, Legal, A4, B5, Post­
       Card, DyseSubLabel. For  the  exact  dimensions  of  these
       sizes,  see  the  note *** in the technical section. NOTE:
       the default size is explicitly set to A4  by  the  driver,
       although  the printers' built-in default varies with coun­
       try.


   -phadjust adjustment
       This option varies the intensity of the print  head  drive
       signal,  making  the  image lighter or darker than normal.
       adjustment may take values between -50 and  +50;  negative
       values make the image darker. It is not known whether this
       option may increase wear on the heads.



   -ppmout
       This is a compatibility option, equivalent  to  -outformat
       PPM.


   -resolution res
       This  option sets the printing resolution. res is an inte­
       ger, with values 600 (default) for 600x600  dpi,  300  for
       300x300 dpi, or 1200 for 1200x600 dpi.


   -satgamma sg
       This  option  gives  a  gamma  correction  factor  that is
       applied to the  saturation  component  of  colour  in  HSV
       space.  sg  is a real, and defaults to 1.0 (no correction)
       except for Floyd-Steinberg dithering, when it defaults  to
       0.8.


   -solidblack
       This  is a compatibility option, equivalent to -keepblack.


   -spotcolours colourspecs
       This option gives the spot colours to be printed after the
       CMYK  colours.  Up  to  four  spot  colours  may be given.
       colourspecs is a comma-separated list of colour specifica­
       tion, each of the form n=col=inspec.

       n  is  an  integer  between  1 and 4; the spot colours are
       printed in order.

       col is the ribbon colour for this component: possible val­
       ues  (abbreviations) are Black (k), Cyan (c), Magenta (m),
       Yellow  (y),  MetallicGold  (mg),  MetallicMagenta   (mm),
       MetallicCyan  (mc),  MetallicSilver (ms), White (w), Gold­
       Foil (gf), SilverFoil (sf), Primer (p), Finish (f),  Over­
       coat  (oc).  Note  that  the Foil ribbons also require the
       CMYK ribbons to be installed,  and  that  the  Finish  and
       Overcoat  ribbons will normally be used via other options.
       (The Primer ribbon is of course normally used as an under­
       colour rather than a spot colour).

       inspec specifies how the spot colour is given in the input
       file.  The following values are possible:
       c,m,y,k means that the spot colour is given by the C,M,Y,K
       value  of  the  input. NOTE: for this calculation, the RGB
       input is converted to CMYK with full black generation  and
       undercolour  removal,  regardless of any options affecting
       colour correction for the normal inks.
       R-range:G-range:B-range specifies a range of  RGB  colours
       in  the  input that give the spot colour. Each range is of
       the form m[-n] where m and n are integers from  0  to  255
       expressed  in  decimal. Hexadecimal values may be given by
       prefixing them with 0x, but octal values  are  not  recog­
       nized.  The spot colour is printed if each of the RGB com­
       ponents lies within the specified ranges.
       notwhite or n means that the spot colour is printed if the
       input  pixel  is  not white (useful with the glossy finish
       ribbon).
       always or a means that the spot colour is printed over the
       entire image. (Useful for glossy finish or undercoats.)
       See also the -spotfile for specifying the spot colours.


       Note that no colour correction or halftoning is applied to
       spot colours; they are either on or off.  Note  also  that
       spot  colours  are printed in addition to CMYK colours; if
       no CMYK colours are needed, use the -colours none  option.

       For pixels where a solid spot colour such as the Metallics
       is printed, the CMYK colours are not printed. For the Foil
       colours, an undercoat of CMYK is printed.

       NOTE:  The  driver will not handle more than seven colours
       (including Glossy Finish if requested) in  total.  If  you
       are  using  a 5000 series printer, load the required seven
       cartridges into the printer. If you are using  a  pre-5000
       series  printer,  then  if (a) you are using four or fewer
       colours, then load those cartridges, or  (b)  if  you  are
       using  more  than  four colours, load the CMYK cartridges;
       then when the printer flashes its error  light,  open  the
       printer,  remove the cartridges in the holders and replace
       them with the remaining spot cartridges (I advise  leaving
       the  empty  holder free).  If you need to handle more than
       seven colours, you must use the -overlay option  to  print
       in several passes.


   -spotfile file
       This option specifies a file containing the input data for
       the spot colours and under colours, instead  of  the  main
       input  file.  This  file must have the same dimensions and
       format as the main input file.


   -undercolours colourspecs
       This option is the same as -spotcolours, except  that  the
       colours  are  printed before the CMYK colours, and have no
       effect on what other colours are printed. The main use  is
       with  white  ink to undercoat on dark paper. (Note that if
       an RGB inspec is used to specify an undercolour, the given
       colour  is also printed as normal on top of the undercoat.
       This is probably not the intended effect! If you  wish  to
       do  special  effects  with undercolours, you should use an
       overlay or spotfile.) See also the -spotfile option.


   -usemulticolourribbon
       This option is available on the pre-5000 series  printers,
       and  instructs the driver that the CMY multi-colour ribbon
       is to be used. This will result in the CMYK colours  being
       printed in two passes instead of four: the first pass will
       be CMY, the second K.


   -version
       This option prints the version number and exits.


   -xshift xoffset
       This option shifts the image in the  x-direction.  xoffset
       may be given in the usual units of measurement; if no unit
       is given, a unit of 1/600 inch is assumed  (regardless  of
       the  resolution setting).  See also -autoshift. A positive
       offset shifts the image right.


   -yshift yoffset
       This option shifts the image in the  y-direction.  xoffset
       may be given in the usual units of measurement; if no unit
       is given, a unit of 1/600 inch is assumed  (regardless  of
       the  resolution setting).  See also -autoshift. A positive
       offset shifts the image down.


USAGE NOTES
       To print a image from a PPM file with halftoning for  pho­
       tos, it suffices to do
       ppmtomd -dither ht file >/dev/printer
       assuming that the printer is on /dev/printer.

       Suppose  that  text.ps is a PostScript file (possibly con­
       taining several pages). To print it in black  only  on  A4
       paper, the following combination of GhostScript and pptomd
       can be used:
         gs -q -dNOPAUSE -dBATCH -sDEVICE=pgmraw
           -sOutputFile='|ppmtomd -autoshift
                                  -black >/dev/printer'
           page.ps

       To print at the highest resolution, do:
         gs -q -dNOPAUSE -dBATCH -sDEVICE=pgmraw -r1200x600
           -sOutputFile='|ppmtomd -autoshift -resolution 1200
                                  -inresolution 1200
                                  -black >/dev/printer'
           page.ps
       Note that using the pbmraw format for GhostScript  is  not
       recommended.   Many  versions  of GhostScript have bugs in
       this format, and there is no efficiency saving, since ppm­
       tomd will convert its input to PPM.


ACKNOWLEDGMENTS
       The writing of this driver is greatly assisted by the man­
       ufacturers.  Citizen originally supplied me with the  com­
       mand  language  spec  for the Printiva printers; Alps sup­
       plied me with the spec for their models; and  Oki  Systems
       (UK) supplied me with a DP-5000 printer for testing.


TECHNICAL NOTES
       This section is not yet written.



J.C.Bradfield                ppmtomd                   PPMTOMD(1)
